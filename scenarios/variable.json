{
  "projectKey": "EVERYTHING",
  "id": "variable",
  "type": "step_based",
  "name": "variable",
  "active": false,
  "versionTag": {
    "versionNumber": 11,
    "lastModifiedBy": {
      "login": "admin"
    },
    "lastModifiedOn": 1631021486762
  },
  "checklists": {
    "checklists": []
  },
  "delayedTriggersBehavior": {
    "delayWhileRunning": true,
    "squashDelayedTriggers": true,
    "suppressTriggersWhileRunning": true
  },
  "tags": [],
  "triggers": [],
  "reporters": [],
  "params": {
    "steps": [
      {
        "id": "custom_python_BPUOLw038ObAUOpRBqDA7Q",
        "type": "custom_python",
        "name": "Step #1",
        "runConditionType": "RUN_IF_STATUS_MATCH",
        "runConditionStatuses": [
          "SUCCESS",
          "WARNING"
        ],
        "runConditionExpression": "",
        "resetScenarioStatus": false,
        "delayBetweenRetries": 10,
        "maxRetriesOnFail": 0,
        "params": {
          "script": "import dataiku\n\n#define required variables for API\nclient \u003d dataiku.api_client()\nprojects \u003d  client.get_project(\"EVERYTHING\")\ndataset \u003d projects.get_dataset(\"year\")\n\n#Retrieve settings to modify the index value \u0026 clear old datas\nmydataset_md \u003d dataset.get_settings()\ndataset.clear()           \nsettings  \u003d mydataset_md.get_raw()\n\n#modifies the index value by the custom variable, \"year\" and saves\nsettings[\u0027params\u0027][\u0027index\u0027] \u003d client.get_variables()[\"year\"]\nmydataset_md.save()\n\n#build dataset\ndataset.build(job_type\u003d\u0027NON_RECURSIVE_FORCED_BUILD\u0027, partitions\u003dNone, wait\u003dTrue, no_fail\u003dFalse)",
          "envSelection": {
            "envMode": "INHERIT"
          },
          "proceedOnFailure": false
        }
      },
      {
        "id": "custom_python_vYG86YnxI+zaJsC4L6n6qQ",
        "type": "custom_python",
        "name": "Step #2",
        "runConditionType": "RUN_IF_STATUS_MATCH",
        "runConditionStatuses": [
          "SUCCESS",
          "WARNING"
        ],
        "runConditionExpression": "",
        "resetScenarioStatus": false,
        "delayBetweenRetries": 10,
        "maxRetriesOnFail": 0,
        "params": {
          "script": "import dataiku\nclient \u003d dataiku.api_client()\n\ntemp \u003d client.get_variables()[\u0027year\u0027]\nnew \u003d int(temp) + 1\nclient.set_variables({\u0027year\u0027:str(new)})",
          "envSelection": {
            "envMode": "INHERIT"
          },
          "proceedOnFailure": false
        }
      }
    ]
  },
  "automationLocal": false,
  "customFields": {}
}